[![Build Status](https://travis-ci.org/bpbond/cosore.svg?branch=master)](https://travis-ci.org/bpbond/cosore) 

[![codecov](https://codecov.io/gh/bpbond/cosore/branch/master/graph/badge.svg)](https://codecov.io/gh/bpbond/cosore)


# cosore

**The _Global Change Biology_** paper is [published](https://onlinelibrary.wiley.com/doi/full/10.1111/gcb.15353)!

The `cosore` package consists of data, metadata, and software tools for COSORE, a reproducibility-oriented 
community database for continuous soil respiration data.

**To use the database from within R**, install this `cosore` package by for example `devtools::install_github("bpbond/cosore")`.

**To download the COSORE database in a flat-file format**, i.e. accessible by any
data analysis tool, click on the
[Releases](https://github.com/bpbond/cosore/releases) tab above.

**A step-by-step guide to using COSORE** is available [here](https://rpubs.com/bpbond/502069).

**To contribute to the database**, fill out the [metadata form](https://forms.gle/xRSY7WwmWKTL6iCv5).

## Principles and general information

Only free use data ([CC BY 4](https://creativecommons.org/licenses/by/4.0/)) accepted.
We request that users cite the 
database definition paper, and strongly encourage them to (i) cite all dataset primary
publications, and (ii) involve data contributors as co-authors when possible.

The package, and the process of contributing and accessing data, should be as focused and 
simple as possible (but no simpler).

All data contributors will be included on an introductory database paper planned for spring 2020.

**COSORE is not designed to be, and should not be treated as, a permanent
data repository.** It is a community database, but not an institutionally-backed repository 
like [Figshare](https://figshare.com), [DataONE](https://www.dataone.org),
[ESS-DIVE](https://ess-dive.lbl.gov), etc. We recommend (but not require)
depositing your data in one of these first,
and providing its DOI in your COSORE dataset metadata.

## Database design

This database is comprised of a collection of datasets, each converted to a standard format and units.
A _dataset_ is one or more files of continuous (automated) soil respiration data,
with accompanying metadata, with all measurements taken at a single _site_ and with
constant _treatment_ assignments (i.e. they may vary between chambers but not over time).

COSORE is designed to be a relatively lightweight database, and metadata are kept to a minimum. 
Each dataset has seven _tables_:

* `description` - includes data on the
site name; location; [timezone name](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones)
and [IGBP cover type](http://www.eomf.ou.edu/static/IGBP.pdf); measurement instrument;
publication and data links; and acknowledgments and notes.
* `contributors` - contributor information, including name, email, [ORCID](https://orcid.org), and
[CRediT role](https://www.casrai.org/credit.html).
* `ports` - continuous systems typically, but not always, are comprised of a single 
analyzer plumbed to multiple chambers through a multiplexer. This table lists,
for each multiplexer port, measurement variable (typically Rs, Rh, or NEE); 
treatment; species, and chamber/collar details.
* `columns` - describes the mapping between the raw _dataset_ fields and 
standardized COSORE fields; used during the import of raw (contributed) data.
* `ancillary` - arbitrary ancillary data: stand structure, carbon cycle, disturbance, etc. [All optional.]
* `data` - the actual chamber respiration data, with many possible fields including the required ones: 
beginning and end timestamps, flux rate, and port number. May also include meteorological
and soil data, flux fit diagnostics, error codes, etc.
* `diagnostics` - this is generated by the data import process, and summarizes
records that were dropped, problems found, etc.

## Operation

Four primary functions are available for R users:
* `csr_database()` returns a summary data frame about the entire database (all constituent datasets)
* `csr_dataset()` returns a single _dataset_, as a list of data frames
* `csr_table()` returns a single _table_, across one or many datasets
* `csr_metadata()` returns a metadata table describing all fields in dataset tables 

Reports can be generated for the overall database (`csr_report_database()`) 
and each individual dataset (`csr_report_dataset()`). 
There are a number of developer functions as well, i.e. not intended for the average
COSORE user. Perhaps most importantly this includes `csr_build()`, which scans for
and parses metadata on all installed datasets, then loads the data,
parsing raw data as necessary and available.

## Data access

R users will find it easiest to install this package and then use the functions above. Anyone can also download flat (csv) files from the [Releases](https://github.com/bpbond/cosore/releases) page.

## Data priorities

* Structured/standardized continuous IRGA data
* Raw LI-8100A data
* Unusual or long-term survey (i.e. not continuous) measurements
